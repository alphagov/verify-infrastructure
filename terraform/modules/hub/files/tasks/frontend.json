[
  {
    "name": "nginx",
    "image": "${nginx_image_identifier}",
    "cpu": 0,
    "memory": 250,
    "essential": true,
    "portMappings": [
      {
        "containerPort": 8443,
        "hostPort": 8443
      }
    ],
    "environment": [
      {
        "Name": "LOCATION_BLOCKS",
        "Value": "${location_blocks_base64}"
      }
    ]
  },
  {
    "name": "frontend",
    "image": "${image_identifier}",
    "cpu": 0,
    "memory": 3500,
    "essential": true,
    "portMappings": [
      {
        "containerPort": 8080,
        "hostPort": 8080
      }
    ],
    "entryPoint": [
      "rails",
      "server",
      "-p",
      "8080",
      "-b",
      "0.0.0.0"
    ],
    "secrets": [
      {
        "name": "SECRET_KEY_BASE",
        "valueFrom": "arn:aws:ssm:${region}:${account_id}:parameter/${deployment}/frontend/secret-key-base"
      }, {
        "name": "SENTRY_DSN",
        "valueFrom": "arn:aws:ssm:${region}:${account_id}:parameter/${deployment}/frontend/sentry-dsn"
      }, {
        "name": "ZENDESK_TOKEN",
        "valueFrom": "arn:aws:ssm:${region}:${account_id}:parameter/${deployment}/frontend/zendesk-token"
      }
    ],
    "environment": [{
      "Name": "SESSION_COOKIE_DURATION_IN_HOURS",
      "Value": "2"
    }, {
      "Name": "CONFIG_API_HOST",
      "Value": "https://config.${domain}:443"
    }, {
      "Name": "POLICY_HOST",
      "Value": "https://policy.${domain}:443"
    }, {
      "Name": "CYCLE_3_DISPLAY_LOCALES",
      "Value": "/verify-frontend/federation/configuration/display-locales/cycle_3"
    }, {
      "Name": "IDP_DISPLAY_LOCALES",
      "Value": "/verify-frontend/federation/configuration/display-locales/idps"
    }, {
      "Name": "COUNTRY_DISPLAY_LOCALES",
      "Value": "/verify-frontend/federation/configuration/display-locales/countries"
    }, {
      "Name": "EIDAS_SCHEMES_DIRECTORY",
      "Value": "/verify-frontend/federation/configuration/eidas/schemes"
    }, {
      "Name": "ZDD_LATCH",
      "Value": ".service_unavailable"
    }, {
      "Name": "POLLING_WAIT_TIME",
      "Value": "2"
    }, {
      "Name": "METRICS_ENABLED",
      "Value": "false"
    }, {
      "Name": "LOG_LEVEL",
      "Value": "warn"
    }, {
      "Name": "RULES_DIRECTORY",
      "Value": "/verify-frontend/federation/configuration/idp-rules"
    }, {
      "Name": "RP_CONFIG",
      "Value": "/verify-frontend/federation/configuration/relying_parties.yml"
    }, {
      "Name": "IDP_CONFIG",
      "Value": "/verify-frontend/federation/configuration/identity_providers.yml"
    }, {
      "Name": "CYCLE_THREE_ATTRIBUTES_DIRECTORY",
      "Value": "/verify-frontend/federation/configuration/cycle-three-attributes"
    }, {
      "Name": "AB_TEST_FILE",
      "Value": "/verify-frontend/federation/configuration/ab_test/ab_test.yml"
    }, {
      "Name": "SEGMENT_DEFINITIONS",
      "Value": "/verify-frontend/federation/configuration/segment_definitions.yml"
    }, {
      "Name": "PUBLIC_PIWIK_HOST",
      "Value": "https://www.${domain}:443/analytics"
    }, {
      "Name": "INTERNAL_PIWIK_HOST",
      "Value": "https://www.${domain}:443/piwik.php"
    }, {
      "Name": "PIWIK_SITE_ID",
      "Value": "${matomo_site_id}"
    }, {
      "Name": "ZENDESK_URL",
      "Value": "${zendesk_url}"
    }, {
      "Name": "ZENDESK_USERNAME",
      "Value": "${zendesk_username}"
    }, {
      "Name": "SAML_PROXY_HOST",
      "Value": "https://saml-proxy.${domain}:443"
    }, {
      "Name": "VERIFY_PRODUCT_PAGE",
      "Value": "https://govuk-verify.cloudapps.digital/"
    }, {
      "Name": "RAILS_ENV",
      "Value": "production"
    }, {
      "Name": "RAILS_LOG_TO_STDOUT",
      "Value": "true"
    }]
  }
]
